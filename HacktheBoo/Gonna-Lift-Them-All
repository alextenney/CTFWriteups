# Gonna Lift Them All

Category : Cryptography
Difficulty: Easy

## Description

Quick, there's a new custom Pokemon in the bush called "The Custom Pokemon". Can you find out what its weakness is and capture it?
## Solve 
### Vulnerabilities

We are given p, g, h and (c1, c2), and we want to find m, the flag. 

c1 = g * y mod p
c1 * g_1 /equiv g * g_1 * y mod p
c * g_1 = y mod p

And since y is smaller than p:
c * g_1 = y

s = h^y mod p
c2 * s = m mod p

And thus, we are able to calculate m with the values given.

Notes: g_1 and s_1 are the inverses of g and s, respectively. 

### Solve Script

```python
p = 163096280281091423983210248406915712517889481034858950909290409636473708049935881617682030048346215988640991054059665720267702269812372029514413149200077540372286640767440712609200928109053348791072129620291461211782445376287196340880230151621619967077864403170491990385250500736122995129377670743204192511487
g = 90013867415033815546788865683138787340981114779795027049849106735163065530238112558925433950669257882773719245540328122774485318132233380232659378189294454934415433502907419484904868579770055146403383222584313613545633012035801235443658074554570316320175379613006002500159040573384221472749392328180810282909
h = 36126929766421201592898598390796462047092189488294899467611358820068759559145016809953567417997852926385712060056759236355651329519671229503584054092862591820977252929713375230785797177168714290835111838057125364932429350418633983021165325131930984126892231131770259051468531005183584452954169653119524751729
(c1, c2) = (159888401067473505158228981260048538206997685715926404215585294103028971525122709370069002987651820789915955483297339998284909198539884370216675928669717336010990834572641551913464452325312178797916891874885912285079465823124506696494765212303264868663818171793272450116611177713890102083844049242593904824396, 119922107693874734193003422004373653093552019951764644568950336416836757753914623024010126542723403161511430245803749782677240741425557896253881748212849840746908130439957915793292025688133503007044034712413879714604088691748282035315237472061427142978538459398404960344186573668737856258157623070654311038584)

g_1 = pow(g, -1, p)
y = g_1 * c1 % p
s = pow(h, y, p)

s_1 = pow(s, -1, p)

m = s_1 * c2 % p

print (hex(m))
```

#### Output 

`0x4854427b62335f6334723366756c5f7768336e5f316d706c336d336e37316e365f63727970373035793537336d355f316e5f3768335f6d756c3731706c316334373176335f36723075707d`

Rather than fight with python type conversion, I used cyberchef to decrypt m from hex back to Ascii.

![](image.png)

## Flag

HTB{b3_c4r3ful_wh3n_1mpl3m3n71n6_cryp705y573m5_1n_7h3_mul71pl1c471v3_6r0up}
